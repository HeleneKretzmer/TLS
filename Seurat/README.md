Most of the analysis, eg clustering, dimension reduction, cell type identification and integration was done in R using Seurat v3.1. 
